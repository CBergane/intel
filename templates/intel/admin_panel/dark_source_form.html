{% extends "base.html" %}

{% block title %}{{ page_title }} | BorealSec Intel{% endblock %}

{% block content %}
<section class="mx-auto max-w-3xl space-y-5">
    <div class="rounded-2xl border border-line bg-panel/80 p-4 shadow-glow">
        <h1 class="text-xl font-semibold text-white">{{ page_title }}</h1>
        {% if mode == "edit" %}
            <p class="mt-1 text-sm text-slate-400">Editing: {{ source.name }}</p>
        {% else %}
            <p class="mt-1 text-sm text-slate-400">Create an allowlisted passive source for dark intel collection.</p>
        {% endif %}
    </div>

    <form method="post" class="rounded-2xl border border-line bg-panel/80 p-5 shadow-glow">
        {% csrf_token %}
        {% if form.non_field_errors %}
            <div class="mb-4 rounded-lg border border-rose-500/40 bg-rose-900/30 p-3 text-sm text-rose-100">
                {{ form.non_field_errors }}
            </div>
        {% endif %}
        <div class="grid gap-4 md:grid-cols-2">
            {% for field in form %}
                <div class="{% if field.name == 'homepage' or field.name == 'url' or field.name == 'tags' or field.name == 'watch_keywords' %}md:col-span-2{% endif %}">
                    <label class="mb-1 block text-xs uppercase tracking-wide text-slate-400" for="{{ field.id_for_label }}">{{ field.label }}</label>
                    {{ field }}
                    {% if field.help_text %}
                        <p class="mt-1 text-xs text-slate-500">{{ field.help_text }}</p>
                    {% endif %}
                    {% if field.errors %}
                        <p class="mt-1 text-xs text-rose-300">{{ field.errors|striptags }}</p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>

        <div class="mt-5 flex flex-wrap gap-2">
            <button type="submit" class="rounded-lg bg-sky-500 px-4 py-2 text-sm font-medium text-slate-950 hover:bg-sky-400">Save</button>
            <a href="{{ cancel_url }}" class="rounded-lg border border-slate-600 px-4 py-2 text-sm text-slate-200 hover:bg-slate-800">Cancel</a>
        </div>
    </form>
</section>
{% endblock %}
